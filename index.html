<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المحاضرة 9 - تطبيقات متقدمة على المكدس</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>    * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            border: 2px solid #2c3e50;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .lecture-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-top: 20px;
            padding: 15px;
            background: #eef2f7;
            border-radius: 10px;
        }
        
        .info-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 10px;
            flex: 1;
            min-width: 200px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            border: 2px solid #2c3e50;
        }
        
        .section-title {
            color: #2980b9;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-left: 10px;
            color: #e74c3c;
        }
        
        .stack-definition, .stack-usage, .stack-properties {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        
        .stack-visual {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 250px;
            margin: 30px 0;
            position: relative;
        }
        
        .stack-item {
            width: 120px;
            height: 50px;
            background: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #2980b9;
            border-radius: 5px;
            margin: 5px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .stack-top {
            background: #e74c3c;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .stack-label {
            position: absolute;
            top: 10px;
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.2rem;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            direction: ltr;
            text-align: left;
        }
        
        .code-comment {
            color: #95a5a6;
        }
        
        .code-keyword {
            color: #3498db;
        }
        
        .code-function {
            color: #9b59b6;
        }
        
        .code-variable {
            color: #2ecc71;
        }
        
        .code-string {
            color: #e74c3c;
        }
        
        .operations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .operation-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-top: 4px solid #3498db;
            transition: transform 0.3s ease;
        }
        
        .operation-card:hover {
            transform: translateY(-5px);
        }
        
        .operation-title {
            color: #2980b9;
            font-size: 1.3rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .operation-title i {
            margin-left: 10px;
            color: #e74c3c;
        }
        
        .example-output {
            background: #f8f9fa;
            border-left: 4px solid #2ecc71;
            padding: 15px;
            border-radius: 0 10px 10px 0;
            margin: 15px 0;
        }
        
        .output-title {
            color: #27ae60;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .comparison {
            display: flex;
            flex-wrap: wrap;
            margin: 20px 0;
            gap: 20px;
        }
        
        .comparison-item {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .comparison-title {
            text-align: center;
            color: #2980b9;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            color: white;
            font-size: 1.1rem;
        }
        
        .algorithm-steps {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        
        .step {
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #3498db;
            color: white;
            text-align: center;
            line-height: 30px;
            border-radius: 50%;
            margin-left: 10px;
        }
        
        .example-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .example-table th, .example-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        
        .example-table th {
            background-color: #3498db;
            color: white;
        }
        
        .example-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .example-table tr:hover {
            background-color: #e3f2fd;
        }
        
        .interactive-converter {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .converter-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .converter-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .converter-input button {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .converter-input button:hover {
            background: #2980b9;
        }
        
        .converter-output {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            min-height: 100px;
        }
        
        .converter-steps {
            margin-top: 15px;
            padding: 10px;
            background: #f0f8ff;
            border-radius: 5px;
        }
        
        .converter-stack {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 15px;
        }
        
        .converter-stack-item {
            width: 100px;
            height: 40px;
            background: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2px;
            border-radius: 4px;
        }
        
        .converter-stack-top {
            background: #e74c3c;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .lecture-info, .comparison {
                flex-direction: column;
            }
            
            .section {
                padding: 20px;
            }
        }</style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-layer-group"></i> المحاضرة 9: تطبيقات متقدمة على المكدس (Stack)</h1>
            <p>جامعة البعث - كلية الهندسة المعلوماتية - السنة الثانية</p>
            
            <div class="lecture-info">
                <div class="info-card">
                    <h3><i class="fas fa-user"></i> المحاضر</h3>
                    <p>ناديا خرسان</p>
                </div>
                <div class="info-card">
                    <h3><i class="fas fa-book"></i> المادة</h3>
                    <p>الخوارزميات وبنى المعطيات 1</p>
                </div>
                <div class="info-card">
                    <h3><i class="fas fa-code"></i> النوع</h3>
                    <p>تطبيقات متقدمة على المكدس</p>
                </div>
            </div>
        </header>
        
        <!-- تحويل الأعداد من العشري إلى الثنائي -->
        <section class="section">
            <h2 class="section-title"><i class="fas fa-exchange-alt"></i> تحويل الأعداد من النظام العشري إلى الثنائي</h2>
            
            <div class="stack-usage">
                <p>تستخدم المكدسات في تحويل الأعداد من النظام العشري إلى الثنائي باستخدام طريقة القسمة على 2 وتخزين الباقي في المكدس</p>
                
                <h3>الخوارزمية:</h3>
                <div class="algorithm-steps">
                    <div class="step">
                        <span class="step-number">1</span>
                        <span>أدخل العدد العشري</span>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <span>كرر العملية حتى يصبح العدد صفراً:</span>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <span>احسب باقي قسمة العدد على 2</span>
                    </div>
                    <div class="step">
                        <span class="step-number">4</span>
                        <span>أدخل الباقي في المكدس</span>
                    </div>
                    <div class="step">
                        <span class="step-number">5</span>
                        <span>اقسم العدد على 2 (قسمة صحيحة)</span>
                    </div>
                    <div class="step">
                        <span class="step-number">6</span>
                        <span>أخرج كل عناصر المكدس للحصول على الرقم الثنائي</span>
                    </div>
                </div>
                
                <h3>مثال: تحويل العدد 10 إلى ثنائي</h3>
                <table class="example-table">
                    <tr>
                        <th>العدد</th>
                        <th>القسمة على 2</th>
                        <th>الباقي</th>
                        <th>المكدس</th>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>10 ÷ 2 = 5</td>
                        <td>0</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>5 ÷ 2 = 2</td>
                        <td>1</td>
                        <td>1, 0</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>2 ÷ 2 = 1</td>
                        <td>0</td>
                        <td>0, 1, 0</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>1 ÷ 2 = 0</td>
                        <td>1</td>
                        <td>1, 0, 1, 0</td>
                    </tr>
                    <tr>
                        <td colspan="4">النتيجة: 1010 (بعد إخراج العناصر من المكدس)</td>
                    </tr>
                </table>
            </div>
            
            <div class="code-block">
                <span class="code-comment">// تحويل العدد العشري إلى ثنائي باستخدام المكدس</span><br>
                <span class="code-keyword">#include</span> &lt;iostream&gt;<br>
                <span class="code-keyword">#include</span> "stack.h"<br><br>
                
                <span class="code-keyword">void</span> <span class="code-function">convert</span>(<span class="code-keyword">int</span> <span class="code-variable">dec</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">Stack</span>&lt;<span class="code-keyword">int</span>&gt; <span class="code-variable">s</span>;<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// قسمة العدد وتخزين الباقي في المكدس</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">while</span>(<span class="code-variable">dec</span> != <span class="code-number">0</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">push</span>(<span class="code-variable">dec</span> % <span class="code-number">2</span>); <span class="code-comment">// إضافة الباقي إلى المكدس</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">dec</span> /= <span class="code-number">2</span>; <span class="code-comment">// القسمة الصحيحة على 2</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;}<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// إخراج العناصر من المكدس للحصول على الرقم الثنائي</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">while</span>(!<span class="code-variable">s</span>.<span class="code-function">isEmpty</span>())<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-variable">s</span>.<span class="code-function">pop</span>();<br>
                }<br><br>
                
                <span class="code-keyword">int</span> <span class="code-function">main</span>() {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">int</span> <span class="code-variable">decimalNum</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-string">"أدخل عدداً عشرياً: "</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;std::cin &gt;&gt; <span class="code-variable">decimalNum</span>;<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-string">"التمثيل الثنائي: "</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">convert</span>(<span class="code-variable">decimalNum</span>);<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> <span class="code-number">0</span>;<br>
                }
            </div>
            
            <div class="interactive-converter">
                <h3><i class="fas fa-calculator"></i> محول تفاعلي: عشري إلى ثنائي</h3>
                <div class="converter-input">
                    <input type="number" id="decimalInput" placeholder="أدخل عدداً عشرياً" min="0" value="10">
                    <button onclick="convertDecimal()">تحويل</button>
                </div>
                <div class="converter-output" id="binaryOutput">النتيجة ستظهر هنا...</div>
                <div class="converter-steps" id="conversionSteps"></div>
                <div class="converter-stack" id="stackVisualization"></div>
            </div>
        </section>
        
        <!-- فحص توازن الأقواس -->
        <section class="section">
            <h2 class="section-title"><i class="fas fa-check-circle"></i> فحص توازن الأقواس</h2>
            
            <div class="stack-usage">
                <p>يستخدم المكدس للتحقق من توازن الأقواس في التعبيرات الرياضية والبرمجية</p>
                
                <h3>الخوارزمية:</h3>
                <div class="algorithm-steps">
                    <div class="step">
                        <span class="step-number">1</span>
                        <span>مرر على كل محرف في النص</span>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <span>إذا كان المحرف قوساً فتحاً: أضفه إلى المكدس</span>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <span>إذا كان المحرف قوساً إغلاقاً:</span>
                    </div>
                    <div class="step">
                        <span class="step-number">4</span>
                        <span>تحقق مما إذا كان المكدس فارغاً (خطأ)</span>
                    </div>
                    <div class="step">
                        <span class="step-number">5</span>
                        <span>تحقق من تطابق القوس مع قمة المكدس</span>
                    </div>
                    <div class="step">
                        <span class="step-number">6</span>
                        <span>إذا تطابق: أزل القوس من المكدس</span>
                    </div>
                    <div class="step">
                        <span class="step-number">7</span>
                        <span>بعد الانتهاء: إذا كان المكدس غير فارغ فهناك خطأ</span>
                    </div>
                </div>
                
                <h3>أمثلة:</h3>
                <table class="example-table">
                    <tr>
                        <th>التعبير</th>
                        <th>الحالة</th>
                        <th>السبب</th>
                    </tr>
                    <tr>
                        <td>[()]{}{[()()]()}</td>
                        <td>صحيح</td>
                        <td>جميع الأقواس متوازنة</td>
                    </tr>
                    <tr>
                        <td>[(])</td>
                        <td>خاطئ</td>
                        <td>عدم تطابق بين الأقواس</td>
                    </tr>
                    <tr>
                        <td>[()</td>
                        <td>خاطئ</td>
                        <td>قوس فتح بدون إغلاق</td>
                    </tr>
                    <tr>
                        <td>())</td>
                        <td>خاطئ</td>
                        <td>قوس إغلاق بدون فتح</td>
                    </tr>
                </table>
            </div>
            
            <div class="code-block">
                <span class="code-comment">// فحص توازن الأقواس باستخدام المكدس</span><br>
                <span class="code-keyword">#include</span> &lt;iostream&gt;<br>
                <span class="code-keyword">#include</span> "stack.h"<br>
                <span class="code-keyword">#include</span> &lt;cstring&gt;<br><br>
                
                <span class="code-keyword">bool</span> <span class="code-function">brackets</span>(<span class="code-keyword">char</span> <span class="code-variable">expr</span>[]) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">Stack</span>&lt;<span class="code-keyword">char</span>&gt; <span class="code-variable">s</span>;<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">for</span> (<span class="code-keyword">int</span> <span class="code-variable">i</span> = <span class="code-number">0</span>; <span class="code-variable">expr</span>[<span class="code-variable">i</span>] != <span class="code-string">'\0'</span>; ++<span class="code-variable">i</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">'('</span> || <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">'['</span> || <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">'{'</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">push</span>(<span class="code-variable">expr</span>[<span class="code-variable">i</span>]); <span class="code-comment">// إضافة قوس الفتح إلى المكدس</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">')'</span> || <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">']'</span> || <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">'}'</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (<span class="code-variable">s</span>.<span class="code-function">isEmpty</span>()) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> <span class="code-keyword">false</span>; <span class="code-comment">// قوس إغلاق بدون فتح</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">char</span> <span class="code-variable">topChar</span> = <span class="code-variable">s</span>.<span class="code-function">getTop</span>();<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> ((<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">')'</span> && <span class="code-variable">topChar</span> == <span class="code-string">'('</span>) ||<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">']'</span> && <span class="code-variable">topChar</span> == <span class="code-string">'['</span>) ||<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="code-variable">expr</span>[<span class="code-variable">i</span>] == <span class="code-string">'}'</span> && <span class="code-variable">topChar</span> == <span class="code-string">'{'</span>)) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">pop</span>(); <span class="code-comment">// إزالة قوس الفتح المقابل</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">else</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> <span class="code-keyword">false</span>; <span class="code-comment">// عدم تطابق الأقواس</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;}<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> <span class="code-variable">s</span>.<span class="code-function">isEmpty</span>(); <span class="code-comment">// إذا كان المكدس فارغاً فالتعبير صحيح</span><br>
                }<br><br>
                
                <span class="code-keyword">int</span> <span class="code-function">main</span>() {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">char</span> <span class="code-variable">expression</span>[<span class="code-number">100</span>];<br>
                &nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-string">"أدخل تعبيراً: "</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;std::cin &gt;&gt; <span class="code-variable">expression</span>;<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (<span class="code-function">brackets</span>(<span class="code-variable">expression</span>)) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-string">"الأقواس متوازنة"</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;} <span class="code-keyword">else</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-string">"الأقواس غير متوازنة"</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> <span class="code-number">0</span>;<br>
                }
            </div>
            
            <div class="interactive-converter">
                <h3><i class="fas fa-check-double"></i> فاحص توازن الأقواس</h3>
                <div class="converter-input">
                    <input type="text" id="expressionInput" placeholder="أدخل تعبيراً" value="{[()]}">
                    <button onclick="checkBrackets()">فحص</button>
                </div>
                <div class="converter-output" id="bracketsOutput">النتيجة ستظهر هنا...</div>
                <div class="converter-steps" id="bracketsSteps"></div>
                <div class="converter-stack" id="bracketsStack"></div>
            </div>
        </section>
        
        <!-- تحويل التعبير من النظام العادي إلى الملحق -->
        <section class="section">
            <h2 class="section-title"><i class="fas fa-arrows-alt-h"></i> تحويل التعبير من النظام العادي (Infix) إلى الملحق (Postfix)</h2>
            
            <div class="stack-usage">
                <p>يستخدم المكدس لتحويل التعبيرات الرياضية من الصيغة العادية (Infix) إلى الصيغة الملحقة (Postfix)</p>
                
                <h3>أنماط التعبيرات الحسابية:</h3>
                <table class="example-table">
                    <tr>
                        <th>النمط</th>
                        <th>الوصف</th>
                        <th>مثال</th>
                    </tr>
                    <tr>
                        <td>Infix (النظامي)</td>
                        <td>العملية بين المعاملات</td>
                        <td>A + B</td>
                    </tr>
                    <tr>
                        <td>Prefix (المصدر)</td>
                        <td>العملية قبل المعاملات</td>
                        <td>+ A B</td>
                    </tr>
                    <tr>
                        <td>Postfix (الملحق)</td>
                        <td>العملية بعد المعاملات</td>
                        <td>A B +</td>
                    </tr>
                </table>
                
                <h3>أولوية العمليات:</h3>
                <div class="algorithm-steps">
                    <div class="step">
                        <span class="step-number">1</span>
                        <span>الأقواس: أعلى أولوية</span>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <span>الأسس والأقواس المربعة</span>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <span>الضرب والقسمة وباقي القسمة</span>
                    </div>
                    <div class="step">
                        <span class="step-number">4</span>
                        <span>الجمع والطرح: أقل أولوية</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
                <span class="code-comment">// تحويل التعبير من Infix إلى Postfix</span><br>
                <span class="code-keyword">#include</span> &lt;iostream&gt;<br>
                <span class="code-keyword">#include</span> "stack.h"<br>
                <span class="code-keyword">#include</span> &lt;cctype&gt; <span class="code-comment">// لـ isdigit و isalpha</span><br><br>
                
                <span class="code-keyword">void</span> <span class="code-function">infixToPostfix</span>(<span class="code-keyword">char</span> <span class="code-variable">exp</span>[]) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">Stack</span>&lt;<span class="code-keyword">char</span>&gt; <span class="code-variable">s</span>;<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">for</span> (<span class="code-keyword">int</span> <span class="code-variable">i</span> = <span class="code-number">0</span>; <span class="code-variable">exp</span>[<span class="code-variable">i</span>] != <span class="code-string">'\0'</span>; ++<span class="code-variable">i</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (<span class="code-function">isdigit</span>(<span class="code-variable">exp</span>[<span class="code-variable">i</span>]) || <span class="code-function">isalpha</span>(<span class="code-variable">exp</span>[<span class="code-variable">i</span>])) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-variable">exp</span>[<span class="code-variable">i</span>]; <span class="code-comment">// خرج المعاملات مباشرة</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">else</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">switch</span> (<span class="code-variable">exp</span>[<span class="code-variable">i</span>]) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">case</span> <span class="code-string">'('</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">push</span>(<span class="code-string">'('</span>); <span class="code-comment">// دفع الأقواس الفتح</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">break</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">case</span> <span class="code-string">'*'</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">case</span> <span class="code-string">'/'</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// إخراج العمليات ذات الأولوية الأعلى أو المتساوية</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">while</span>(!<span class="code-variable">s</span>.<span class="code-function">isEmpty</span>() && (<span class="code-variable">s</span>.<span class="code-function">getTop</span>() == <span class="code-string">'*'</span> || <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">getTop</span>() == <span class="code-string">'/'</span>)) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-variable">s</span>.<span class="code-function">pop</span>();<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">push</span>(<span class="code-variable">exp</span>[<span class="code-variable">i</span>]); <span class="code-comment">// دفع العملية الحالية</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">break</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">case</span> <span class="code-string">'+'</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">case</span> <span class="code-string">'-'</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// إخراج جميع العمليات حتى قوس الفتح</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">while</span>(!<span class="code-variable">s</span>.<span class="code-function">isEmpty</span>() && <span class="code-variable">s</span>.<span class="code-function">getTop</span>() != <span class="code-string">'('</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-variable">s</span>.<span class="code-function">pop</span>();<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">push</span>(<span class="code-variable">exp</span>[<span class="code-variable">i</span>]);<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">break</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">case</span> <span class="code-string">')'</span>:<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// إخراج جميع العمليات حتى قوس الفتح</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">while</span>(!<span class="code-variable">s</span>.<span class="code-function">isEmpty</span>() && <span class="code-variable">s</span>.<span class="code-function">getTop</span>() != <span class="code-string">'('</span>) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-variable">s</span>.<span class="code-function">pop</span>();<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (!<span class="code-variable">s</span>.<span class="code-function">isEmpty</span>()) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-variable">s</span>.<span class="code-function">pop</span>(); <span class="code-comment">// إزالة قوس الفتح</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">break</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                &nbsp;&nbsp;&nbsp;&nbsp;}<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// إخراج العمليات المتبقية في المكدس</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">while</span>(!<span class="code-variable">s</span>.<span class="code-function">isEmpty</span>()) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-variable">s</span>.<span class="code-function">pop</span>();<br>
                &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                }<br><br>
                
                <span class="code-keyword">int</span> <span class="code-function">main</span>() {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">char</span> <span class="code-variable">exp</span>[<span class="code-number">30</span>];<br>
                &nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-string">"أدخل تعبيراً عادياً (Infix): "</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;std::cin &gt;&gt; <span class="code-variable">exp</span>;<br><br>
                
                &nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; <span class="code-string">"التعبير الملحق (Postfix): "</span>;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">infixToPostfix</span>(<span class="code-variable">exp</span>);<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> <span class="code-number">0</span>;<br>
                }
            </div>
            
            <div class="interactive-converter">
                <h3><i class="fas fa-exchange-alt"></i> محول التعبيرات</h3>
                <div class="converter-input">
                    <input type="text" id="infixInput" placeholder="أدخل تعبيراً عادياً" value="(8/(9-8+3))*(6-1)*2">
                    <button onclick="convertInfix()">تحويل</button>
                </div>
                <div class="converter-output" id="postfixOutput">النتيجة ستظهر هنا...</div>
                <div class="converter-steps" id="infixSteps"></div>
                <div class="converter-stack" id="infixStack"></div>
            </div>
        </section>
        
        <footer>
            <p>جامعة حمص - كلية الهندسة المعلوماتية | الخوارزميات وبنى المعطيات 1 | المحاضرة 9</p>
            <p>إعداد: ناديا خرسان</p>
        </footer>
    </div>

    <script>
        // تحويل الأعداد من العشري إلى الثنائي
        function convertDecimal() {
            const decimalInput = document.getElementById('decimalInput');
            const binaryOutput = document.getElementById('binaryOutput');
            const conversionSteps = document.getElementById('conversionSteps');
            const stackVisualization = document.getElementById('stackVisualization');
            
            const decimalNum = parseInt(decimalInput.value);
            if (isNaN(decimalNum)) {
                binaryOutput.textContent = "الرجاء إدخال رقم صحيح";
                return;
            }
            
            let num = decimalNum;
            let steps = "";
            let stack = [];
            
            // مسح التصور السابق
            stackVisualization.innerHTML = '';
            conversionSteps.innerHTML = '<h4>خطوات التحويل:</h4>';
            
            // عملية التحويل
            while (num > 0) {
                const remainder = num % 2;
                num = Math.floor(num / 2);
                stack.push(remainder);
                
                steps += `<div class="step">${decimalNum} ÷ 2 = ${Math.floor(decimalNum / 2)} (باقي ${remainder}) - تم إضافة ${remainder} إلى المكدس</div>`;
                
                // تحديث التصور
                updateStackVisualization(stackVisualization, stack);
            }
            
            // بناء النتيجة
            let binaryResult = "";
            while (stack.length > 0) {
                const digit = stack.pop();
                binaryResult += digit;
                steps += `<div class="step">تم إخراج ${digit} من المكدس</div>`;
                updateStackVisualization(stackVisualization, stack);
            }
            
            binaryOutput.textContent = `الرقم الثنائي: ${binaryResult || '0'}`;
            conversionSteps.innerHTML += steps;
        }
        
        // فحص توازن الأقواس
        function checkBrackets() {
            const expressionInput = document.getElementById('expressionInput');
            const bracketsOutput = document.getElementById('bracketsOutput');
            const bracketsSteps = document.getElementById('bracketsSteps');
            const bracketsStack = document.getElementById('bracketsStack');
            
            const expression = expressionInput.value;
            let stack = [];
            let valid = true;
            let steps = '<h4>خطوات الفحص:</h4>';
            
            // مسح التصور السابق
            bracketsStack.innerHTML = '';
            bracketsSteps.innerHTML = '';
            
            for (let i = 0; i < expression.length; i++) {
                const char = expression[i];
                
                if (char === '(' || char === '[' || char === '{') {
                    // قوس فتح - أضفه إلى المكدس
                    stack.push(char);
                    steps += `<div class="step">'${char}' - تم إضافة قوس فتح إلى المكدس</div>`;
                    updateStackVisualization(bracketsStack, stack);
                } 
                else if (char === ')' || char === ']' || char === '}') {
                    // قوس إغلاق - تحقق من المكدس
                    if (stack.length === 0) {
                        valid = false;
                        steps += `<div class="step" style="color:red">'${char}' - خطأ: قوس إغلاق بدون فتح</div>`;
                        break;
                    }
                    
                    const lastOpen = stack.pop();
                    let expected;
                    
                    switch (char) {
                        case ')': expected = '('; break;
                        case ']': expected = '['; break;
                        case '}': expected = '{'; break;
                    }
                    
                    if (lastOpen !== expected) {
                        valid = false;
                        steps += `<div class="step" style="color:red">'${char}' - خطأ: لا يتطابق مع '${lastOpen}'</div>`;
                        break;
                    }
                    
                    steps += `<div class="step">'${char}' - يتطابق مع '${lastOpen}' - تم إزالته من المكدس</div>`;
                    updateStackVisualization(bracketsStack, stack);
                }
            }
            
            // تحقق من بقاء المكدس فارغاً
            if (valid && stack.length > 0) {
                valid = false;
                steps += `<div class="step" style="color:red">خطأ: أقواس فتح بدون إغلاق</div>`;
            }
            
            bracketsOutput.textContent = valid ? "الأقواس متوازنة" : "الأقواس غير متوازنة";
            bracketsOutput.style.color = valid ? "green" : "red";
            bracketsSteps.innerHTML += steps;
        }
        
        // تحويل التعبير من النظام العادي إلى الملحق
        function convertInfix() {
            const infixInput = document.getElementById('infixInput');
            const postfixOutput = document.getElementById('postfixOutput');
            const infixSteps = document.getElementById('infixSteps');
            const infixStack = document.getElementById('infixStack');
            
            const expression = infixInput.value;
            let stack = [];
            let output = "";
            let steps = '<h4>خطوات التحويل:</h4>';
            
            // مسح التصور السابق
            infixStack.innerHTML = '';
            infixSteps.innerHTML = '';
            
            // أولوية العمليات
            const precedence = {
                '+': 1,
                '-': 1,
                '*': 2,
                '/': 2
            };
            
            for (let i = 0; i < expression.length; i++) {
                const char = expression[i];
                
                if (/[a-zA-Z0-9]/.test(char)) {
                    // معامل - أخرجه مباشرة
                    output += char;
                    steps += `<div class="step">'${char}' - معامل، تم إضافته إلى الناتج</div>`;
                } 
                else if (char === '(') {
                    // قوس فتح - أضفه إلى المكدس
                    stack.push(char);
                    steps += `<div class="step">'${char}' - قوس فتح، تم إضافته إلى المكدس</div>`;
                    updateStackVisualization(infixStack, stack);
                } 
                else if (char === ')') {
                    // قوس إغلاق - أخرج كل العمليات حتى قوس الفتح
                    steps += `<div class="step">'${char}' - قوس إغلاق، إخراج العمليات حتى قوس الفتح</div>`;
                    
                    while (stack.length > 0 && stack[stack.length - 1] !== '(') {
                        const op = stack.pop();
                        output += op;
                        steps += `<div class="step">تم إخراج '${op}' من المكدس وإضافته إلى الناتج</div>`;
                        updateStackVisualization(infixStack, stack);
                    }
                    
                    if (stack.length > 0 && stack[stack.length - 1] === '(') {
                        stack.pop(); // إزالة قوس الفتح
                        updateStackVisualization(infixStack, stack);
                    }
                } 
                else if (char in precedence) {
                    // عملية - أخرج العمليات ذات الأولوية الأعلى أو المتساوية
                    while (stack.length > 0 && 
                           stack[stack.length - 1] !== '(' && 
                           precedence[stack[stack.length - 1]] >= precedence[char]) {
                        const op = stack.pop();
                        output += op;
                        steps += `<div class="step">تم إخراج '${op}' من المكدس وإضافته إلى الناتج</div>`;
                        updateStackVisualization(infixStack, stack);
                    }
                    
                    stack.push(char);
                    steps += `<div class="step">'${char}' - عملية، تم إضافتها إلى المكدس</div>`;
                    updateStackVisualization(infixStack, stack);
                }
            }
            
            // أخرج العمليات المتبقية في المكدس
            while (stack.length > 0) {
                const op = stack.pop();
                output += op;
                steps += `<div class="step">تم إخراج '${op}' من المكدس وإضافته إلى الناتج</div>`;
                updateStackVisualization(infixStack, stack);
            }
            
            postfixOutput.textContent = `التعبير الملحق: ${output}`;
            infixSteps.innerHTML += steps;
        }
        
        // تحديث تصور المكدس
        function updateStackVisualization(container, stack) {
            container.innerHTML = '';
            
            if (stack.length === 0) {
                container.innerHTML = '<div class="converter-stack-item">المكدس فارغ</div>';
                return;
            }
            
            // إنشاء نسخة عكسية لتظهر القمة في الأعلى
            const reversed = [...stack].reverse();
            
            reversed.forEach((item, index) => {
                const stackItem = document.createElement('div');
                stackItem.className = 'converter-stack-item';
                if (index === 0) {
                    stackItem.classList.add('converter-stack-top');
                    stackItem.textContent = `${item} (قمة)`;
                } else {
                    stackItem.textContent = item;
                }
                container.appendChild(stackItem);
            });
        }
    </script>
</body>
</html>